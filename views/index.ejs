<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>とーか管理パネル</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <div id="loader-container">
      <div class="loader">Loading...</div>
    </div>

    <div class="container" style="display: none;">
      <!-- 認証コンテナ -->
      <div id="auth-container" style="display: none;">
        <!-- ログインフォーム -->
        <form id="login-form" style="display: none;">
          <h2>ログイン</h2>
          <div class="form-group">
            <input
              type="email"
              id="login-email"
              placeholder="メールアドレス"
              required
            />
          </div>
          <div class="form-group">
            <input
              type="password"
              id="login-password"
              placeholder="パスワード"
              required
            />
          </div>
          <div class="form-actions">
            <button type="button" id="login-btn">ログイン</button>
            <a href="#" id="forgot-password-link">パスワードを忘れた場合</a>
            <a href="#" id="show-register-form-link">新規登録</a>
          </div>
        </form>

        <!-- 登録フォーム -->
        <form id="register-form" style="display: none;">
          <h2>新規登録</h2>
          <div class="form-group">
            <input
              type="text"
              id="register-invite-code"
              placeholder="招待コード"
              required
            />
          </div>
          <div class="form-group">
            <input
              type="text"
              id="register-display-name"
              placeholder="表示名"
              required
            />
          </div>
          <div class="form-group">
            <input
              type="email"
              id="register-email"
              placeholder="メールアドレス"
              required
            />
          </div>
          <div class="form-group">
            <input
              type="password"
              id="register-password"
              placeholder="パスワード"
              required
            />
          </div>
          <div class="form-actions">
            <button type="button" id="register-btn">登録</button>
            <a href="#" id="show-login-form-link">ログイン画面に戻る</a>
          </div>
        </form>
      </div>

      <!-- メインコンテンツ -->
      <div id="main-content" style="display: none;">
        <header>
          <h1>とーか管理パネル</h1>
          <div class="user-info">
            <span id="user-email"></span>
            <button id="logout-btn">ログアウト</button>
          </div>
        </header>

        <nav>
          <ul>
            <li>
              <a href="#" class="nav-link active" data-target="panel-profile"
                >プロファイル</a
              >
            </li>
            <li>
              <a href="#" class="nav-link" data-target="panel-toka"
                >とーか設定</a
              >
            </li>
            <li>
              <a href="#" class="nav-link" data-target="panel-ai">AI管理</a>
            </li>
            <li>
              <a href="#" class="nav-link" data-target="panel-schedule"
                >スケジュール</a
              >
            </li>
            <li id="nav-item-admin" style="display: none;">
              <a href="#" class="nav-link" data-target="panel-admins">管理者</a>
            </li>
          </ul>
        </nav>

        <div id="status-message"></div>

        <div class="save-all-container">
          <button id="save-all-btn">すべての設定を保存</button>
        </div>

        <!-- プロファイルパネル -->
        <div id="panel-profile" class="dashboard-panel">
          <h2>プロファイル設定</h2>
          <div class="form-group">
            <label>表示名</label>
            <input type="text" id="profile-display-name" placeholder="表示名" />
          </div>
          <div class="form-group">
            <label>メールアドレス</label>
            <input
              type="email"
              id="profile-email"
              placeholder="メールアドレス"
            />
          </div>
          <button id="save-profile-btn">保存</button>
        </div>

        <!-- とーか設定パネル -->
        <div id="panel-toka" class="dashboard-panel" style="display: none;">
          <h2>とーか設定</h2>
          <div class="form-group">
            <label>モデルモード</label>
            <select id="toka-model-mode">
              <option value="hybrid">ハイブリッド</option>
              <option value="gpt-4">GPT-4</option>
              <option value="gpt-3.5-turbo">GPT-3.5</option>
            </select>
          </div>
          <div class="form-group">
            <label>ベースユーザーID</label>
            <input
              type="text"
              id="base-user-id-input"
              placeholder="ベースとなるユーザーID"
            />
          </div>
          <div class="form-group">
            <label>システムプロンプト</label>
            <textarea
              id="prompt-textarea"
              placeholder="システムプロンプト"
            ></textarea>
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox" id="name-recognition-checkbox" />
              名前認識を有効化
            </label>
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox" id="bot-message-response-checkbox" />
              BOTメッセージへの応答を有効化
            </label>
          </div>
          <div class="form-group">
            <label>返信遅延（ミリ秒）</label>
            <input type="number" id="reply-delay-ms-input" min="0" value="0" />
          </div>
          <div class="form-group">
            <label>エラーメッセージ</label>
            <input
              type="text"
              id="error-oops-message-input"
              placeholder="エラー時のメッセージ"
            />
          </div>
          <div class="form-group">
            <label>ニックネーム</label>
            <div id="nicknames-list-container"></div>
            <button type="button" id="add-nickname-btn">
              ニックネームを追加
            </button>
          </div>
          <button id="save-toka-btn">保存</button>
        </div>

        <!-- AI管理パネル -->
        <div id="panel-ai" class="dashboard-panel" style="display: none;">
          <h2>AI管理</h2>
          <button id="add-ai-btn">新しいAIを追加</button>
          <div id="ai-list"></div>
        </div>

        <!-- スケジュールパネル -->
        <div id="panel-schedule" class="dashboard-panel" style="display: none;">
          <h2>スケジュール設定</h2>
          <div class="settings-section">
            <h3>通知設定</h3>
            <div class="form-group">
              <label>
                <input type="checkbox" id="reminders-enabled-checkbox" />
                リマインダーを有効化
              </label>
            </div>
            <div class="form-group">
              <label>通知時刻</label>
              <input type="time" id="reminder-time-input" />
            </div>
            <div class="form-group">
              <label>スプレッドシートID</label>
              <input
                type="text"
                id="google-sheet-id-input"
                placeholder="GoogleスプレッドシートのID"
              />
            </div>
            <div class="form-group">
              <label>通知サーバーID</label>
              <input
                type="text"
                id="reminder-guild-id-input"
                placeholder="DiscordサーバーID"
              />
            </div>
            <div class="form-group">
              <label>通知ロールID</label>
              <input
                type="text"
                id="reminder-role-id-input"
                placeholder="DiscordロールID"
              />
            </div>
            <button id="save-schedule-settings-btn">設定を保存</button>
          </div>
          <div class="schedule-items-section">
            <h3>予定リスト</h3>
            <div id="schedule-items-container"></div>
            <button id="add-schedule-item-btn">予定を追加</button>
            <button id="save-schedule-items-btn">予定を保存</button>
          </div>
        </div>

        <!-- 管理者パネル -->
        <div id="panel-admins" class="dashboard-panel" style="display: none;">
          <h2>管理者設定</h2>
          <div id="invite-code-generator-section" style="display: none;">
            <h3>招待コード生成</h3>
            <button id="generate-invite-code-btn">招待コードを生成</button>
            <div id="invite-code-display" style="display: none;">
              <input type="text" id="new-invite-code" readonly />
              <button id="copy-invite-code-btn">コピー</button>
            </div>
          </div>
          <div class="admins-section">
            <h3>管理者一覧</h3>
            <div id="admins-list-container"></div>
            <button id="add-admin-btn">管理者を追加</button>
            <button id="save-admins-btn">管理者リストを保存</button>
          </div>
        </div>
      </div>
    </div>

    <!-- AIキャラクターのテンプレート -->
    <template id="ai-card-template">
      <div class="ai-card">
        <div class="ai-header">
          <span class="ai-name"></span>
          <span class="ai-command"></span>
          <label>
            <input type="checkbox" class="ai-active-toggle" />
            有効
          </label>
          <button type="button" class="edit-ai-btn">編集</button>
          <button type="button" class="delete-ai-btn">削除</button>
        </div>
        <div class="ai-edit-form" style="display: none;">
          <div class="form-group">
            <label>名前 *</label>
            <input
              type="text"
              class="ai-display-name"
              placeholder="AIキャラクターの名前"
              required
            />
          </div>
          <div class="form-group">
            <label>ベースユーザーID *</label>
            <input
              type="text"
              class="ai-base-user-id"
              placeholder="ベースとなるユーザーID"
              required
            />
          </div>
          <div class="form-group">
            <label>システムプロンプト *</label>
            <textarea
              class="ai-system-prompt"
              placeholder="AIの振る舞いを定義するプロンプト"
              required
            ></textarea>
          </div>
          <div class="form-group">
            <label>モデルモード</label>
            <select class="ai-model-mode">
              <option value="hybrid">ハイブリッド</option>
              <option value="gpt-4">GPT-4</option>
              <option value="gpt-3.5-turbo">GPT-3.5</option>
            </select>
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox" class="ai-name-recognition" />
              名前認識を有効化
            </label>
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox" class="ai-bot-response" />
              BOTメッセージへの応答を有効化
            </label>
          </div>
          <div class="form-group">
            <label>返信遅延（ミリ秒）</label>
            <input type="number" class="ai-reply-delay" min="0" value="0" />
          </div>
          <div class="form-group">
            <label>エラーメッセージ</label>
            <input
              type="text"
              class="ai-error-message"
              placeholder="エラー時のメッセージ"
            />
          </div>
          <div class="form-group">
            <label>ニックネーム</label>
            <div class="ai-nicknames-list"></div>
            <button type="button" class="add-nickname-btn">
              ニックネームを追加
            </button>
          </div>
          <div class="form-actions">
            <button type="button" class="save-ai-btn">保存</button>
            <button type="button" class="cancel-ai-btn">キャンセル</button>
          </div>
        </div>
      </div>
    </template>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>

    <!-- アプリケーションの設定とメインスクリプト -->
    <script src="/firebase-config.js"></script>
    <script src="/main.js"></script>
  </body>
</html>
